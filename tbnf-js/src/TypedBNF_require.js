"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "MK_Declctor", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Declctor;
  }
});
Object.defineProperty(exports, "MK_Decltype", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Decltype;
  }
});
Object.defineProperty(exports, "MK_Declvar", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Declvar;
  }
});
Object.defineProperty(exports, "MK_Defignore", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Defignore;
  }
});
Object.defineProperty(exports, "MK_Deflexer", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Deflexer;
  }
});
Object.defineProperty(exports, "MK_Defmacro", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Defmacro;
  }
});
Object.defineProperty(exports, "MK_Defrule", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Defrule;
  }
});
Object.defineProperty(exports, "MK_EApp", {
  enumerable: true,
  get: function () {
    return _APIs.MK_EApp;
  }
});
Object.defineProperty(exports, "MK_EBool", {
  enumerable: true,
  get: function () {
    return _APIs.MK_EBool;
  }
});
Object.defineProperty(exports, "MK_EField", {
  enumerable: true,
  get: function () {
    return _APIs.MK_EField;
  }
});
Object.defineProperty(exports, "MK_EFlt", {
  enumerable: true,
  get: function () {
    return _APIs.MK_EFlt;
  }
});
Object.defineProperty(exports, "MK_EFun", {
  enumerable: true,
  get: function () {
    return _APIs.MK_EFun;
  }
});
Object.defineProperty(exports, "MK_EInt", {
  enumerable: true,
  get: function () {
    return _APIs.MK_EInt;
  }
});
Object.defineProperty(exports, "MK_ELet", {
  enumerable: true,
  get: function () {
    return _APIs.MK_ELet;
  }
});
Object.defineProperty(exports, "MK_EList", {
  enumerable: true,
  get: function () {
    return _APIs.MK_EList;
  }
});
Object.defineProperty(exports, "MK_ESlot", {
  enumerable: true,
  get: function () {
    return _APIs.MK_ESlot;
  }
});
Object.defineProperty(exports, "MK_EStr", {
  enumerable: true,
  get: function () {
    return _APIs.MK_EStr;
  }
});
Object.defineProperty(exports, "MK_ETuple", {
  enumerable: true,
  get: function () {
    return _APIs.MK_ETuple;
  }
});
Object.defineProperty(exports, "MK_EVar", {
  enumerable: true,
  get: function () {
    return _APIs.MK_EVar;
  }
});
exports.MK_Expr = void 0;
Object.defineProperty(exports, "MK_LGroup", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LGroup;
  }
});
Object.defineProperty(exports, "MK_LNot", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LNot;
  }
});
Object.defineProperty(exports, "MK_LNumber", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LNumber;
  }
});
Object.defineProperty(exports, "MK_LOptional", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LOptional;
  }
});
Object.defineProperty(exports, "MK_LOr", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LOr;
  }
});
Object.defineProperty(exports, "MK_LPlus", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LPlus;
  }
});
Object.defineProperty(exports, "MK_LRange", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LRange;
  }
});
Object.defineProperty(exports, "MK_LRef", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LRef;
  }
});
Object.defineProperty(exports, "MK_LSeq", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LSeq;
  }
});
Object.defineProperty(exports, "MK_LStar", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LStar;
  }
});
Object.defineProperty(exports, "MK_LStr", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LStr;
  }
});
Object.defineProperty(exports, "MK_LWildcard", {
  enumerable: true,
  get: function () {
    return _APIs.MK_LWildcard;
  }
});
Object.defineProperty(exports, "MK_Macrocall", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Macrocall;
  }
});
Object.defineProperty(exports, "MK_Mono", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Mono;
  }
});
Object.defineProperty(exports, "MK_Nonterm", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Nonterm;
  }
});
Object.defineProperty(exports, "MK_Poly", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Poly;
  }
});
Object.defineProperty(exports, "MK_TApp", {
  enumerable: true,
  get: function () {
    return _APIs.MK_TApp;
  }
});
Object.defineProperty(exports, "MK_TConst", {
  enumerable: true,
  get: function () {
    return _APIs.MK_TConst;
  }
});
Object.defineProperty(exports, "MK_TFun", {
  enumerable: true,
  get: function () {
    return _APIs.MK_TFun;
  }
});
Object.defineProperty(exports, "MK_TList", {
  enumerable: true,
  get: function () {
    return _APIs.MK_TList;
  }
});
Object.defineProperty(exports, "MK_TTuple", {
  enumerable: true,
  get: function () {
    return _APIs.MK_TTuple;
  }
});
Object.defineProperty(exports, "MK_TVar", {
  enumerable: true,
  get: function () {
    return _APIs.MK_TVar;
  }
});
Object.defineProperty(exports, "MK_Term", {
  enumerable: true,
  get: function () {
    return _APIs.MK_Term;
  }
});
Object.defineProperty(exports, "MK_expr", {
  enumerable: true,
  get: function () {
    return _APIs.MK_expr;
  }
});
Object.defineProperty(exports, "MK_production", {
  enumerable: true,
  get: function () {
    return _APIs.MK_production;
  }
});
Object.defineProperty(exports, "Token", {
  enumerable: true,
  get: function () {
    return _antlr4ts.Token;
  }
});
exports.addList = addList;
Object.defineProperty(exports, "definition", {
  enumerable: true,
  get: function () {
    return _Grammar.definition;
  }
});
Object.defineProperty(exports, "expr", {
  enumerable: true,
  get: function () {
    return _Grammar.expr;
  }
});
exports.fst = fst;
exports.getfilename = getfilename;
exports.getpos = getpos;
exports.getrange = getrange;
exports.getunicoderange = getunicoderange;
Object.defineProperty(exports, "lexerule", {
  enumerable: true,
  get: function () {
    return _Grammar.lexerule;
  }
});
exports.list_index = list_index;
exports.mkpos = mkpos;
Object.defineProperty(exports, "monot", {
  enumerable: true,
  get: function () {
    return _Grammar.monot;
  }
});
Object.defineProperty(exports, "node", {
  enumerable: true,
  get: function () {
    return _Grammar.node;
  }
});
Object.defineProperty(exports, "polyt", {
  enumerable: true,
  get: function () {
    return _Grammar.polyt;
  }
});
Object.defineProperty(exports, "position", {
  enumerable: true,
  get: function () {
    return _Grammar.position;
  }
});
exports.process_tparam = process_tparam;
Object.defineProperty(exports, "production", {
  enumerable: true,
  get: function () {
    return _Grammar.production;
  }
});
exports.setfilename = setfilename;
exports.snd = snd;
exports.str = str;
Object.defineProperty(exports, "symbol", {
  enumerable: true,
  get: function () {
    return _Grammar.symbol;
  }
});
exports.tofloat = tofloat;
exports.toint = toint;
exports.unescape = unescape;

var _APIs = require("./src/APIs");

var _Grammar = require("./src/Grammar");

var _antlr4ts = require("antlr4ts");

// export all imported from '.APIs.fs' and '.Grammar.fs'
function fst(x) {
  return x[0];
}

function snd(x) {
  return x[1];
}

function list_index(x, i) {
  return x[i];
}

let MK_Expr = _APIs.MK_expr;
exports.MK_Expr = MK_Expr;

function addList(xs, b) {
  xs.push(b);
  return xs;
} // parse a literal string starts with a '"' and ends with a'"';
// unescape '\b', '\t', '\n', '\f', '\r', '\\', '\"', '\'


function unescape(s) {
  let r = "";
  let i = 1;
  let n = s.length - 1;

  while (i < n) {
    if (s[i] == '\\') {
      i++;

      switch (s[i]) {
        case 'b':
          r += '\b';
          break;

        case 't':
          r += '\t';
          break;

        case 'n':
          r += '\n';
          break;

        case 'f':
          r += '\f';
          break;

        case 'r':
          r += '\r';
          break;

        case '\\':
          r += '\\';
          break;

        case '\"':
          r += '\"';
          break;

        case '\'':
          r += '\'';
          break;

        default:
          r += s[i];
          break;
      }
    } else {
      r += s[i];
    }

    i++;
  }

  return r;
}

let _curfname = "<no file>";

function setfilename(fname) {
  _curfname = fname;
}

function getfilename() {
  return _curfname;
}

function mkpos(t) {
  return new _Grammar.position(t.line, t.charPositionInLine, getfilename());
}

function getpos(e) {
  return e.pos;
}

function process_tparam(xs) {
  let out = []; // traverse xs, for each pair of 'name' and 'type', if 'name' == '_', change it to 'value$i', where i is the index of the pair in xs

  for (let i = 0; i < xs.length; i++) {
    if (xs[i][0] == '_') {
      out.push(['value' + i, xs[i][1]]);
    } else {
      out.push(xs[i]);
    }
  }

  return out;
}

function str(x) {
  return x.text;
}

function toint(x) {
  if (x.text == undefined) throw new Error("toint: undefined token");
  return parseInt(x.text);
}

function tofloat(x) {
  if (x.text == undefined) throw new Error("tofloat: undefined token");
  return parseFloat(x.text);
}

function getunicoderange(x) {
  let [a, b] = x.substring(1, x.length - 1).split('-'); // 'a' and 'b' are in unicode form like '\u0041'
  // convert them to integer form like '65'

  return (0, _APIs.MK_LRange)(parseInt(a.substring(2), 16), parseInt(b.substring(2), 16));
}

function getrange(x) {
  let [a, b] = x.substring(1, x.length - 1).split('-');
  return (0, _APIs.MK_LRange)(a.codePointAt(0), b.codePointAt(0));
}